(self.webpackChunkstrapi_backend=self.webpackChunkstrapi_backend||[]).push([[8853],{20400:(m,E,t)=>{"use strict";t.r(E),t.d(E,{default:()=>bt});var e=t(67294),i=t(16550),n=t(81849),r=t(31498),l=t(81912),p=t(14087),u=t(17034),f=t(185),A=t(53979),x=t(29728),M=t(36989),b=t(49066),I=t(38939),D=t(8060),L=t(79031),P=t(37909),g=t(75515),U=t(63237),B=t(96315),Z=t(86896),F=t(88767),te=t(90233),w=t(89031);const Te=async(s,o)=>{try{const{get:a}=(0,n.tg)(),{data:c}=await a((0,w.Gc)("roles"));return o("The roles have loaded successfully"),c}catch{throw s({type:"warning",message:{id:"notification.error"}}),new Error("error")}},De=async(s,o)=>{try{const{del:a}=(0,n.tg)();await a(`${(0,w.Gc)("roles")}/${s}`)}catch{o({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}};var xe=t(45697),k=t.n(xe),be=t(15234),N=t(11047),re=t(12028),Le=t(4585),Me=t(20022);const ne=({sortedRoles:s,canDelete:o,permissions:a,setRoleToDelete:c,onDelete:y})=>{const{formatMessage:d}=(0,Z.Z)(),{push:v}=(0,i.k6)(),[C,T]=y,R=h=>o&&!["public","authenticated"].includes(h.type),O=h=>{c(h),T(!C)},S=h=>{v(`/settings/${r.Z}/roles/${h}`)};return e.createElement(be.p,null,s?.map(h=>e.createElement(L.Tr,{key:h.name,...(0,n.X7)({fn:()=>S(h.id)})},e.createElement(P.Td,{width:"20%"},e.createElement(g.Z,null,h.name)),e.createElement(P.Td,{width:"50%"},e.createElement(g.Z,null,h.description)),e.createElement(P.Td,{width:"30%"},e.createElement(g.Z,null,`${h.nb_users} ${d({id:"global.users",defaultMessage:"users"}).toLowerCase()}`)),e.createElement(P.Td,null,e.createElement(N.k,{justifyContent:"end",...n.UW},e.createElement(n.jW,{permissions:a.updateRole},e.createElement(re.h,{onClick:()=>S(h.id),noBorder:!0,icon:e.createElement(Le.Z,null),label:d({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:`${h.name}`})})),R(h)&&e.createElement(n.jW,{permissions:a.deleteRole},e.createElement(re.h,{onClick:()=>O(h.id),noBorder:!0,icon:e.createElement(Me.Z,null),label:d({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${h.name}`})})))))))},Oe=ne;ne.defaultProps={canDelete:!1},ne.propTypes={onDelete:k().array.isRequired,permissions:k().object.isRequired,setRoleToDelete:k().func.isRequired,sortedRoles:k().array.isRequired,canDelete:k().bool};const Ze=()=>{const{trackUsage:s}=(0,n.rS)(),{formatMessage:o}=(0,Z.Z)(),{push:a}=(0,i.k6)(),c=(0,n.lm)(),{notifyStatus:y}=(0,p.G)(),[{query:d}]=(0,n.Kx)(),v=d?._q||"",[C,T]=(0,e.useState)(!1),[R,O]=(0,e.useState)(!1),[S,h]=(0,e.useState)();(0,n.go)();const $=(0,F.useQueryClient)(),K=(0,e.useMemo)(()=>({create:l.Z.createRole,read:l.Z.readRoles,update:l.Z.updateRole,delete:l.Z.deleteRole}),[]),{isLoading:G,allowedActions:{canRead:j,canDelete:H}}=(0,n.ss)(K),{isLoading:X,data:{roles:Ce},isFetching:Lt}=(0,F.useQuery)("get-roles",()=>Te(c,y),{initialData:{},enabled:j}),Pe=X||Lt,Mt=()=>{s("willCreateRole"),a(`/settings/${r.Z}/roles/new`)},Ot=()=>{T(!C)},Zt={roles:{id:(0,w.OB)("Roles.empty"),defaultMessage:"You don't have any roles yet."},search:{id:(0,w.OB)("Roles.empty.search"),defaultMessage:"No roles match the search."}},St=o({id:"global.roles",defaultMessage:"Roles"}),Bt=(0,F.useMutation)(Gt=>De(Gt,c),{async onSuccess(){await $.invalidateQueries("get-roles")}}),Ut=async()=>{O(!0),await Bt.mutateAsync(S),T(!C),O(!1)},ee=(0,te.Z)(Ce||[],v,{keys:["name","description"]}),It=v&&!ee.length?"search":"roles",kt=4,Nt=(Ce?.length||0)+1;return e.createElement(u.A,null,e.createElement(n.SL,{name:St}),e.createElement(f.o,{"aria-busy":Pe},e.createElement(A.T,{title:o({id:"global.roles",defaultMessage:"Roles"}),subtitle:o({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),primaryAction:e.createElement(n.jW,{permissions:l.Z.createRole},e.createElement(x.z,{onClick:Mt,startIcon:e.createElement(B.Z,null),size:"S"},o({id:(0,w.OB)("List.button.roles"),defaultMessage:"Add new role"})))}),e.createElement(M.Z,{startActions:e.createElement(n.m,{label:o({id:"app.component.search.label",defaultMessage:"Search"})})}),e.createElement(b.D,null,!j&&e.createElement(n.ZF,null),(Pe||G)&&e.createElement(n.dO,null),j&&ee&&ee?.length?e.createElement(I.i,{colCount:kt,rowCount:Nt},e.createElement(D.h,null,e.createElement(L.Tr,null,e.createElement(P.Th,null,e.createElement(g.Z,{variant:"sigma",textColor:"neutral600"},o({id:"global.name",defaultMessage:"Name"}))),e.createElement(P.Th,null,e.createElement(g.Z,{variant:"sigma",textColor:"neutral600"},o({id:"global.description",defaultMessage:"Description"}))),e.createElement(P.Th,null,e.createElement(g.Z,{variant:"sigma",textColor:"neutral600"},o({id:"global.users",defaultMessage:"Users"}))),e.createElement(P.Th,null,e.createElement(U.T,null,o({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Oe,{sortedRoles:ee,canDelete:H,permissions:l.Z,setRoleToDelete:h,onDelete:[C,T]})):e.createElement(n.x7,{content:Zt[It]})),e.createElement(n.QH,{isConfirmButtonLoading:R,onConfirm:Ut,onToggleDialog:Ot,isOpen:C})))},Se=()=>e.createElement(n.O4,{permissions:l.Z.accessRoles},e.createElement(Ze,null));var oe=t(41054),W=t(41580),J=t(11276),V=t(74571),ie=t(16364),le=t(64256),ce=t(85018),Be=t(67109),z=t(84757),Ue=t(27361),Q=t.n(Ue),Ie=t(41609),ke=t.n(Ie),Ne=t(82569),Ge=t.n(Ne);const de=(0,e.createContext)({}),ue=({children:s,value:o})=>e.createElement(de.Provider,{value:o},s),se=()=>(0,e.useContext)(de);ue.propTypes={children:k().node.isRequired,value:k().object.isRequired};var q=t(1565),$e=t(35161),je=t.n($e),We=t(13217),Fe=t.n(We);const we=s=>{switch(s){case"POST":return{text:"success600",border:"success200",background:"success100"};case"GET":return{text:"secondary600",border:"secondary200",background:"secondary100"};case"PUT":return{text:"warning600",border:"warning200",background:"warning100"};case"DELETE":return{text:"danger600",border:"danger200",background:"danger100"};default:return{text:"neutral600",border:"neutral200",background:"neutral100"}}},Ke=(0,q.ZP)(W.x)`
  margin: -1px;
  border-radius: ${({theme:s})=>s.spaces[1]} 0 0 ${({theme:s})=>s.spaces[1]};
`;function ae({route:s}){const{formatMessage:o}=(0,Z.Z)(),{method:a,handler:c,path:y}=s,d=y?Fe()(y.split("/")):[],[v="",C=""]=c?c.split("."):[],T=we(s.method);return e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:2},e.createElement(g.Z,{variant:"delta",as:"h3"},o({id:"users-permissions.BoundRoute.title",defaultMessage:"Bound route to"}),"\xA0",e.createElement("span",null,v),e.createElement(g.Z,{variant:"delta",textColor:"primary600"},".",C)),e.createElement(N.k,{hasRadius:!0,background:"neutral0",borderColor:"neutral200",gap:0},e.createElement(Ke,{background:T.background,borderColor:T.border,padding:2},e.createElement(g.Z,{fontWeight:"bold",textColor:T.text},a)),e.createElement(W.x,{paddingLeft:2,paddingRight:2},je()(d,R=>e.createElement(g.Z,{key:R,textColor:R.includes(":")?"neutral600":"neutral900"},"/",R)))))}ae.defaultProps={route:{handler:"Nocontroller.error",method:"GET",path:"/there-is-no-path"}},ae.propTypes={route:k().shape({handler:k().string,method:k().string,path:k().string})};const He=ae,Ve=()=>{const{formatMessage:s}=(0,Z.Z)(),{selectedAction:o,routes:a}=se(),c=Ge()(o.split("."),"controllers"),y=Q()(a,c[0]),d=c.slice(1).join("."),v=ke()(y)?[]:y.filter(C=>C.handler.endsWith(d));return e.createElement(V.P,{col:5,background:"neutral150",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,style:{minHeight:"100%"}},o?e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:2},v.map((C,T)=>e.createElement(He,{key:T,route:C}))):e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:2},e.createElement(g.Z,{variant:"delta",as:"h3"},s({id:"users-permissions.Policies.header.title",defaultMessage:"Advanced settings"})),e.createElement(g.Z,{as:"p",textColor:"neutral600"},s({id:"users-permissions.Policies.header.hint",defaultMessage:"Select the application's actions or the plugin's actions and click on the cog icon to display the bound route"}))))};var ze=t(48734),Ye=t(74756),Xe=t(63081),Qe=t(11700),Je=t.n(Qe);function qe(s){switch(s){case"application":return"Application";case"plugin::content-manager":return"Content manager";case"plugin::content-type-builder":return"Content types builder";case"plugin::documentation":return"Documentation";case"plugin::email":return"Email";case"plugin::i18n":return"i18n";case"plugin::upload":return"Upload";case"plugin::users-permissions":return"Users-permissions";default:return Je()(s.replace("api::","").replace("plugin::",""))}}const _e=qe;var et=t(89734),me=t.n(et),ge=t(36213),tt=t(78114);const pe=q.iv`
  background: ${s=>s.theme.colors.primary100};
  svg {
    opacity: 1;
  }
`,nt=(0,q.ZP)(W.x)`
  display: flex;
  justify-content: space-between;
  align-items: center;

  svg {
    opacity: 0;
    path {
      fill: ${s=>s.theme.colors.primary600};
    }
  }

  /* Show active style both on hover and when the action is selected */
  ${s=>s.isActive&&pe}
  &:hover {
    ${pe}
  }
`,st=q.ZP.div`
  flex: 1;
  align-self: center;
  border-top: 1px solid ${({theme:s})=>s.colors.neutral150};
`,Ee=({subCategory:s})=>{const{formatMessage:o}=(0,Z.Z)(),{onChange:a,onChangeSelectAll:c,onSelectedAction:y,selectedAction:d,modifiedData:v}=se(),C=(0,e.useMemo)(()=>Q()(v,s.name,{}),[v,s]),T=(0,e.useMemo)(()=>Object.values(C).every(h=>h.enabled===!0),[C]),R=(0,e.useMemo)(()=>Object.values(C).some(h=>h.enabled===!0)&&!T,[C,T]),O=(0,e.useCallback)(({target:{name:h}})=>{c({target:{name:h,value:!T}})},[T,c]),S=(0,e.useCallback)(h=>d===h,[d]);return e.createElement(W.x,null,e.createElement(N.k,{justifyContent:"space-between",alignItems:"center"},e.createElement(W.x,{paddingRight:4},e.createElement(g.Z,{variant:"sigma",textColor:"neutral600"},s.label)),e.createElement(st,null),e.createElement(W.x,{paddingLeft:4},e.createElement(ge.X,{name:s.name,value:T,onValueChange:h=>O({target:{name:s.name,value:h}}),indeterminate:R},o({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(N.k,{paddingTop:6,paddingBottom:6},e.createElement(J.r,{gap:2,style:{flex:1}},s.actions.map(h=>{const $=`${h.name}.enabled`;return e.createElement(V.P,{col:6,key:h.name},e.createElement(nt,{isActive:S(h.name),padding:2,hasRadius:!0},e.createElement(ge.X,{value:Q()(v,$,!1),name:$,onValueChange:K=>a({target:{name:$,value:K}})},h.label),e.createElement("button",{type:"button","data-testid":"action-cog",onClick:()=>y(h.name),style:{display:"inline-flex",alignItems:"center"}},e.createElement(tt.Z,null))))}))))};Ee.propTypes={subCategory:k().object.isRequired};const at=Ee,he=({name:s,permissions:o})=>{const a=(0,e.useMemo)(()=>me()(Object.values(o.controllers).reduce((c,y,d)=>{const v=`${s}.controllers.${Object.keys(o.controllers)[d]}`,C=me()(Object.keys(y).reduce((T,R)=>[...T,{...y[R],label:R,name:`${v}.${R}`}],[]),"label");return[...c,{actions:C,label:Object.keys(o.controllers)[d],name:v}]},[]),"label"),[s,o]);return e.createElement(W.x,{padding:6},a.map(c=>e.createElement(at,{key:c.name,subCategory:c})))};he.propTypes={name:k().string.isRequired,permissions:k().object.isRequired};const rt=he,ot=(s,o)=>{const a=Object.keys(o).sort().map(c=>({name:c,isOpen:!1}));return{...s,collapses:a}};var _=t(18172);const it={collapses:[]},lt=(s,o)=>(0,_.ZP)(s,a=>{switch(o.type){case"TOGGLE_COLLAPSE":{a.collapses=s.collapses.map((c,y)=>y===o.index?{...c,isOpen:!c.isOpen}:{...c,isOpen:!1});break}default:return a}}),ct=()=>{const{modifiedData:s}=se(),{formatMessage:o}=(0,Z.Z)(),[{collapses:a},c]=(0,e.useReducer)(lt,it,d=>ot(d,s)),y=d=>c({type:"TOGGLE_COLLAPSE",index:d});return e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:1},a.map((d,v)=>e.createElement(ze.U,{expanded:d.isOpen,onToggle:()=>y(v),key:d.name,variant:v%2===0?"secondary":void 0},e.createElement(Ye.B,{title:_e(d.name),description:o({id:"users-permissions.Plugin.permissions.plugins.description",defaultMessage:"Define all allowed actions for the {name} plugin."},{name:d.name}),variant:v%2?"primary":"secondary"}),e.createElement(Xe.v,null,e.createElement(W.x,null,e.createElement(rt,{permissions:s[d.name],name:d.name}))))))};var dt=t(36968),fe=t.n(dt),ut=t(69572),mt=t.n(ut);const gt={initialData:{},modifiedData:{},routes:{},selectedAction:"",policies:[]},pt=(s,o)=>(0,_.ZP)(s,a=>{switch(o.type){case"ON_CHANGE":{const c=o.keys.length,y=o.keys[c-1]==="enabled";if(o.value&&y){const d=mt()(o.keys,c-1).join(".");a.selectedAction=d}fe()(a,["modifiedData",...o.keys],o.value);break}case"ON_CHANGE_SELECT_ALL":{const c=["modifiedData",...o.keys],y=Q()(s,c,{}),d=Object.keys(y).reduce((v,C)=>(v[C]={...y[C],enabled:o.value},v),{});fe()(a,c,d);break}case"ON_RESET":{a.modifiedData=s.initialData;break}case"ON_SUBMIT_SUCCEEDED":{a.initialData=s.modifiedData;break}case"SELECT_ACTION":{const{actionToSelect:c}=o;a.selectedAction=c===s.selectedAction?"":c;break}default:return a}}),Et=(s,o,a)=>({...s,initialData:o,modifiedData:o,routes:a}),ye=(0,e.forwardRef)(({permissions:s,routes:o},a)=>{const{formatMessage:c}=(0,Z.Z)(),[y,d]=(0,e.useReducer)(pt,gt,O=>Et(O,s,o));(0,e.useImperativeHandle)(a,()=>({getPermissions(){return{permissions:y.modifiedData}},resetForm(){d({type:"ON_RESET"})},setFormAfterSubmit(){d({type:"ON_SUBMIT_SUCCEEDED"})}}));const R={...y,onChange:({target:{name:O,value:S}})=>d({type:"ON_CHANGE",keys:O.split("."),value:S==="empty__string_value"?"":S}),onChangeSelectAll:({target:{name:O,value:S}})=>d({type:"ON_CHANGE_SELECT_ALL",keys:O.split("."),value:S}),onSelectedAction:O=>d({type:"SELECT_ACTION",actionToSelect:O})};return e.createElement(ue,{value:R},e.createElement(J.r,{gap:0,shadow:"filterShadow",hasRadius:!0,background:"neutral0"},e.createElement(V.P,{col:7,paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:6},e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:2},e.createElement(g.Z,{variant:"delta",as:"h2"},c({id:(0,z.Z)("Plugins.header.title"),defaultMessage:"Permissions"})),e.createElement(g.Z,{as:"p",textColor:"neutral600"},c({id:(0,z.Z)("Plugins.header.description"),defaultMessage:"Only actions bound by a route are listed below."}))),e.createElement(ct,null))),e.createElement(Ve,null)))});ye.propTypes={permissions:k().object.isRequired,routes:k().object.isRequired};const ve=(0,e.memo)(ye),Yt={isLoading:!0,modifiedData:{}},Xt=(s,o)=>produce(s,a=>{switch(o.type){case"GET_DATA":{a.isLoading=!0,a.modifiedData={};break}case"GET_DATA_SUCCEEDED":{a.isLoading=!1,a.modifiedData=o.data;break}case"GET_DATA_ERROR":{a.isLoading=!0;break}case"ON_SUBMIT_SUCCEEDED":{a.modifiedData=o.data;break}default:return a}}),Qt=null,Jt=(s,o)=>{const{isLoading:a,allowedActions:c}=useRBAC(o),[{isLoading:y,modifiedData:d},v]=useReducer(reducer,initialState),C=useNotification(),T=useRef(!0),R=new AbortController,{signal:O}=R;useEffect(()=>(a||(async()=>{try{v({type:"GET_DATA"});const $=await request(getRequestURL(s),{method:"GET",signal:O});v({type:"GET_DATA_SUCCEEDED",data:$})}catch($){T.current&&(v({type:"GET_DATA_ERROR"}),console.error($),C({type:"warning",message:{id:"notification.error"}}))}})(),()=>{R.abort(),T.current=!1}),[a,s]);const S=useCallback(h=>{v({type:"ON_SUBMIT_SUCCEEDED",data:h})},[]);return{allowedActions:c,dispatchSubmitSucceeded:S,isLoading:y,isLoadingForPermissions:a,modifiedData:d}},qt=null,_t={roles:[],isLoading:!0},en=(s,o)=>produce(s,a=>{switch(o.type){case"GET_DATA":{a.isLoading=!0,a.roles=[];break}case"GET_DATA_SUCCEEDED":{a.roles=o.data,a.isLoading=!1;break}case"GET_DATA_ERROR":{a.isLoading=!1;break}default:return a}}),tn=null,nn=(s=!0)=>{const[{roles:o,isLoading:a},c]=useReducer(reducer,initialState,()=>init(initialState,s)),y=useNotification(),d=useRef(!0),v=new AbortController,{signal:C}=v;useEffect(()=>(s&&T(),()=>{v.abort(),d.current=!1}),[s]);const T=async()=>{try{c({type:"GET_DATA"});const{roles:R}=await request(`/${pluginId}/roles`,{method:"GET",signal:C});c({type:"GET_DATA_SUCCEEDED",data:R})}catch(R){const O=get(R,["response","payload","message"],"An error occured");d.current&&(c({type:"GET_DATA_ERROR"}),O!=="Forbidden"&&y({type:"warning",message:O}))}};return{roles:o,isLoading:a,getData:T}},sn=null,ht=(s,o)=>({...s,isLoading:o}),Re={permissions:{},routes:{},isLoading:!0},ft=(s,o)=>(0,_.ZP)(s,a=>{switch(o.type){case"GET_DATA":{a.isLoading=!0,a.permissions={},a.routes={};break}case"GET_DATA_SUCCEEDED":{a.permissions=o.permissions,a.routes=o.routes,a.isLoading=!1;break}case"GET_DATA_ERROR":{a.isLoading=!1;break}default:return a}}),Ae=(s=!0)=>{const o=(0,n.lm)(),[{permissions:a,routes:c,isLoading:y},d]=(0,e.useReducer)(ft,Re,()=>ht(Re,s)),v=(0,n.kY)(),C=(0,e.useCallback)(async()=>{try{d({type:"GET_DATA"});const[{permissions:T},{routes:R}]=await Promise.all([`/${r.Z}/permissions`,`/${r.Z}/routes`].map(async O=>(await v.get(O)).data));d({type:"GET_DATA_SUCCEEDED",permissions:(0,w.YX)(T),routes:R})}catch(T){const R=Q()(T,["response","payload","message"],"An error occured");d({type:"GET_DATA_ERROR"}),R!=="Forbidden"&&o({type:"warning",message:R})}},[o]);return(0,e.useEffect)(()=>{s&&C()},[C,s]),{permissions:a,routes:c,getData:C,isLoading:y}},yt={role:{},isLoading:!0},vt=(s,o)=>(0,_.ZP)(s,a=>{switch(o.type){case"GET_DATA_SUCCEEDED":{a.role=o.role,a.isLoading=!1;break}case"GET_DATA_ERROR":{a.isLoading=!1;break}case"ON_SUBMIT_SUCCEEDED":{a.role.name=o.name,a.role.description=o.description;break}default:return a}}),Rt=s=>{const[o,a]=(0,e.useReducer)(vt,yt),c=(0,n.lm)(),y=(0,e.useRef)(null),{get:d}=(0,n.kY)();(0,e.useEffect)(()=>(y.current=!0,s?v(s):a({type:"GET_DATA_SUCCEEDED",role:{}}),()=>y.current=!1),[s]);const v=async T=>{try{const{data:{role:R}}=await d(`/${r.Z}/roles/${T}`);y.current&&a({type:"GET_DATA_SUCCEEDED",role:R})}catch(R){console.error(R),a({type:"GET_DATA_ERROR"}),c({type:"warning",message:{id:"notification.error"}})}},C=(0,e.useCallback)(T=>{a({type:"ON_SUBMIT_SUCCEEDED",...T})},[]);return{...o,onSubmitSucceeded:C}};var Y=t(87561);const At=Y.Ry().shape({name:Y.Z_().required(n.I0.required),description:Y.Z_().required(n.I0.required)}),Ct=()=>{const{formatMessage:s}=(0,Z.Z)(),[o,a]=(0,e.useState)(!1),c=(0,n.lm)(),{lockApp:y,unlockApp:d}=(0,n.o1)(),{params:{id:v}}=(0,i.$B)(`/settings/${r.Z}/roles/:id`),{isLoading:C,routes:T}=Ae(),{role:R,onSubmitSucceeded:O,isLoading:S}=Rt(v),h=(0,e.useRef)(),{put:$}=(0,n.kY)(),K=async G=>{y(),a(!0);try{const j=h.current.getPermissions();await $(`/${r.Z}/roles/${v}`,{...G,...j,users:[]}),O({name:G.name,description:G.description}),c({type:"success",message:{id:(0,z.Z)("Settings.roles.edited"),defaultMessage:"Role edited"}})}catch(j){console.error(j),c({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}a(!1),d()};return S?e.createElement(n.dO,null):e.createElement(f.o,null,e.createElement(n.SL,{name:"Roles"}),e.createElement(oe.J9,{enableReinitialize:!0,initialValues:{name:R.name,description:R.description},onSubmit:K,validationSchema:At},({handleSubmit:G,values:j,handleChange:H,errors:X})=>e.createElement(n.l0,{noValidate:!0,onSubmit:G},e.createElement(A.T,{primaryAction:!C&&e.createElement(x.z,{disabled:R.code==="strapi-super-admin",type:"submit",loading:o,startIcon:e.createElement(ce.Z,null)},s({id:"global.save",defaultMessage:"Save"})),title:R.name,subtitle:R.description,navigationAction:e.createElement(n.rU,{startIcon:e.createElement(Be.Z,null),to:"/settings/users-permissions/roles"},s({id:"global.back",defaultMessage:"Back"}))}),e.createElement(b.D,null,e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:7},e.createElement(W.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(g.Z,{variant:"delta",as:"h2"},s({id:(0,z.Z)("EditPage.form.roles"),defaultMessage:"Role details"})),e.createElement(J.r,{gap:4},e.createElement(V.P,{col:6},e.createElement(ie.o,{name:"name",value:j.name||"",onChange:H,label:s({id:"global.name",defaultMessage:"Name"}),error:X.name?s({id:X.name,defaultMessage:"Invalid value"}):null})),e.createElement(V.P,{col:6},e.createElement(le.g,{name:"description",value:j.description||"",onChange:H,label:s({id:"global.description",defaultMessage:"Description"}),error:X.description?s({id:X.description,defaultMessage:"Invalid value"}):null}))))),!C&&e.createElement(ve,{ref:h,permissions:R.permissions,routes:T}))))))},Pt=()=>e.createElement(n.O4,{permissions:l.Z.updateRole},e.createElement(Ct,null)),Tt=Y.Ry().shape({name:Y.Z_().required(n.I0.required),description:Y.Z_().required(n.I0.required)}),Dt=()=>{const{formatMessage:s}=(0,Z.Z)(),[o,a]=(0,e.useState)(!1),c=(0,n.lm)(),{goBack:y}=(0,i.k6)(),{lockApp:d,unlockApp:v}=(0,n.o1)(),{isLoading:C,permissions:T,routes:R}=Ae(),{trackUsage:O}=(0,n.rS)(),S=(0,e.useRef)(),{post:h}=(0,n.kY)(),$=async K=>{d(),a(!0);try{const G=S.current.getPermissions();await h(`/${r.Z}/roles`,{...K,...G,users:[]}),O("didCreateRole"),c({type:"success",message:{id:(0,z.Z)("Settings.roles.created"),defaultMessage:"Role created"}}),y()}catch(G){console.error(G),c({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}a(!1),v()};return e.createElement(f.o,null,e.createElement(n.SL,{name:"Roles"}),e.createElement(oe.J9,{enableReinitialize:!0,initialValues:{name:"",description:""},onSubmit:$,validationSchema:Tt},({handleSubmit:K,values:G,handleChange:j,errors:H})=>e.createElement(n.l0,{noValidate:!0,onSubmit:K},e.createElement(A.T,{primaryAction:!C&&e.createElement(x.z,{type:"submit",loading:o,startIcon:e.createElement(ce.Z,null)},s({id:"global.save",defaultMessage:"Save"})),title:s({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:s({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"})}),e.createElement(b.D,null,e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:7},e.createElement(W.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(N.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(g.Z,{variant:"delta",as:"h2"},s({id:(0,z.Z)("EditPage.form.roles"),defaultMessage:"Role details"})),e.createElement(J.r,{gap:4},e.createElement(V.P,{col:6},e.createElement(ie.o,{name:"name",value:G.name||"",onChange:j,label:s({id:"global.name",defaultMessage:"Name"}),error:H.name?s({id:H.name,defaultMessage:"Invalid value"}):null})),e.createElement(V.P,{col:6},e.createElement(le.g,{name:"description",value:G.description||"",onChange:j,label:s({id:"global.description",defaultMessage:"Description"}),error:H.description?s({id:H.description,defaultMessage:"Invalid value"}):null}))))),!C&&e.createElement(ve,{ref:S,permissions:T,routes:R}))))))},xt=()=>e.createElement(n.O4,{permissions:l.Z.createRole},e.createElement(Dt,null)),bt=()=>e.createElement(n.O4,{permissions:l.Z.accessRoles},e.createElement(i.rs,null,e.createElement(i.AW,{path:`/settings/${r.Z}/roles/new`,component:xt,exact:!0}),e.createElement(i.AW,{path:`/settings/${r.Z}/roles/:id`,component:Pt,exact:!0}),e.createElement(i.AW,{path:`/settings/${r.Z}/roles`,component:Se,exact:!0}),e.createElement(i.AW,{path:"",component:n.NotFound})))},89031:(m,E,t)=>{"use strict";t.d(E,{YX:()=>r,Gc:()=>u,OB:()=>f.Z});var e=t(41609),i=t.n(e);const r=A=>Object.keys(A).reduce((x,M)=>{const b=A[M].controllers,I=Object.keys(b).reduce((D,L)=>(i()(b[L])||(D[L]=b[L]),D),{});return i()(I)||(x[M]={controllers:I}),x},{});var l=t(31498);const u=A=>`/${l.Z}/${A}`;var f=t(84757)},47443:(m,E,t)=>{var e=t(42118);function i(n,r){var l=n==null?0:n.length;return!!l&&e(n,r,0)>-1}m.exports=i},1196:m=>{function E(t,e,i){for(var n=-1,r=t==null?0:t.length;++n<r;)if(i(e,t[n]))return!0;return!1}m.exports=E},20731:(m,E,t)=>{var e=t(88668),i=t(47443),n=t(1196),r=t(29932),l=t(7518),p=t(74757),u=200;function f(A,x,M,b){var I=-1,D=i,L=!0,P=A.length,g=[],U=x.length;if(!P)return g;M&&(x=r(x,l(M))),b?(D=n,L=!1):x.length>=u&&(D=p,L=!1,x=new e(x));e:for(;++I<P;){var B=A[I],Z=M==null?B:M(B);if(B=b||B!==0?B:0,L&&Z===Z){for(var F=U;F--;)if(x[F]===Z)continue e;g.push(B)}else D(x,Z,b)||g.push(B)}return g}m.exports=f},89881:(m,E,t)=>{var e=t(47816),i=t(99291),n=i(e);m.exports=n},41848:m=>{function E(t,e,i,n){for(var r=t.length,l=i+(n?1:-1);n?l--:++l<r;)if(e(t[l],l,t))return l;return-1}m.exports=E},42118:(m,E,t)=>{var e=t(41848),i=t(62722),n=t(42351);function r(l,p,u){return p===p?n(l,p,u):e(l,i,u)}m.exports=r},62722:m=>{function E(t){return t!==t}m.exports=E},69199:(m,E,t)=>{var e=t(89881),i=t(98612);function n(r,l){var p=-1,u=i(r)?Array(r.length):[];return e(r,function(f,A,x){u[++p]=l(f,A,x)}),u}m.exports=n},82689:(m,E,t)=>{var e=t(29932),i=t(97786),n=t(67206),r=t(69199),l=t(71131),p=t(7518),u=t(85022),f=t(6557),A=t(1469);function x(M,b,I){b.length?b=e(b,function(P){return A(P)?function(g){return i(g,P.length===1?P[0]:P)}:P}):b=[f];var D=-1;b=e(b,p(n));var L=r(M,function(P,g,U){var B=e(b,function(Z){return Z(P)});return{criteria:B,index:++D,value:P}});return l(L,function(P,g){return u(P,g,I)})}m.exports=x},71131:m=>{function E(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t}m.exports=E},26393:(m,E,t)=>{var e=t(33448);function i(n,r){if(n!==r){var l=n!==void 0,p=n===null,u=n===n,f=e(n),A=r!==void 0,x=r===null,M=r===r,b=e(r);if(!x&&!b&&!f&&n>r||f&&A&&M&&!x&&!b||p&&A&&M||!l&&M||!u)return 1;if(!p&&!f&&!b&&n<r||b&&l&&u&&!p&&!f||x&&l&&u||!A&&u||!M)return-1}return 0}m.exports=i},85022:(m,E,t)=>{var e=t(26393);function i(n,r,l){for(var p=-1,u=n.criteria,f=r.criteria,A=u.length,x=l.length;++p<A;){var M=e(u[p],f[p]);if(M){if(p>=x)return M;var b=l[p];return M*(b=="desc"?-1:1)}}return n.index-r.index}m.exports=i},99291:(m,E,t)=>{var e=t(98612);function i(n,r){return function(l,p){if(l==null)return l;if(!e(l))return n(l,p);for(var u=l.length,f=r?u:-1,A=Object(l);(r?f--:++f<u)&&p(A[f],f,A)!==!1;);return l}}m.exports=i},42351:m=>{function E(t,e,i){for(var n=i-1,r=t.length;++n<r;)if(t[n]===e)return n;return-1}m.exports=E},35161:(m,E,t)=>{var e=t(29932),i=t(67206),n=t(69199),r=t(1469);function l(p,u){var f=r(p)?e:n;return f(p,i(u,3))}m.exports=l},89734:(m,E,t)=>{var e=t(21078),i=t(82689),n=t(5976),r=t(16612),l=n(function(p,u){if(p==null)return[];var f=u.length;return f>1&&r(p,u[0],u[1])?u=[]:f>2&&r(u[0],u[1],u[2])&&(u=[u[0]]),i(p,e(u,1),[])});m.exports=l},13217:(m,E,t)=>{var e=t(14259);function i(n){var r=n==null?0:n.length;return r?e(n,1,r):[]}m.exports=i},69572:(m,E,t)=>{var e=t(14259),i=t(40554);function n(r,l,p){return r&&r.length?(l=p||l===void 0?1:i(l),e(r,0,l<0?0:l)):[]}m.exports=n},82569:(m,E,t)=>{var e=t(20731),i=t(5976),n=t(29246),r=i(function(l,p){return n(l)?e(l,p):[]});m.exports=r},36989:(m,E,t)=>{"use strict";t.d(E,{Z:()=>f});var e=t(67294),i=t(45697),n=t(1565),r=t(41580),l=t(11047);const p=(0,n.ZP)(l.k)`
  & > * + * {
    margin-left: ${({theme:A})=>A.spaces[2]};
  }

  margin-left: ${({pullRight:A})=>A?"auto":void 0};
`,u=(0,n.ZP)(p)`
  flex-shrink: 0;
`,f=({startActions:A,endActions:x})=>A||x?e.createElement(r.x,{paddingLeft:10,paddingRight:10},e.createElement(r.x,{paddingBottom:4},e.createElement(l.k,{justifyContent:"space-between",alignItems:"flex-start"},A&&e.createElement(p,{wrap:"wrap"},A),x&&e.createElement(u,{pullRight:!0},x)))):null;f.defaultProps={endActions:void 0,startActions:void 0},f.propTypes={endActions:i.node,startActions:i.node}},49066:(m,E,t)=>{"use strict";t.d(E,{D:()=>r});var e=t(67294),i=t(45697),n=t(41580);const r=({children:l})=>e.createElement(n.x,{paddingLeft:10,paddingRight:10},l);r.propTypes={children:i.node.isRequired}},53979:(m,E,t)=>{"use strict";t.d(E,{A:()=>I,T:()=>M});var e=t(67294),i=t(45697),n=t(1565),r=t(41580),l=t(11047);const p=D=>{const L=(0,e.useRef)(null),[P,g]=(0,e.useState)(!0),U=([B])=>{g(B.isIntersecting)};return(0,e.useEffect)(()=>{const B=L.current,Z=new IntersectionObserver(U,D);return B&&Z.observe(L.current),()=>{B&&Z.disconnect()}},[L,D]),[L,P]};var u=t(95355);const f=(D,L)=>{const P=(0,u.W)(L);(0,e.useLayoutEffect)(()=>{const g=new ResizeObserver(P);return Array.isArray(D)?D.forEach(U=>{U.current&&g.observe(U.current)}):D.current&&g.observe(D.current),()=>{g.disconnect()}},[D,P])};var A=t(75515);const x=()=>{const D=(0,e.useRef)(null),[L,P]=(0,e.useState)(null),[g,U]=p({root:null,rootMargin:"0px",threshold:0});return f(g,()=>{g.current&&P(g.current.getBoundingClientRect())}),(0,e.useEffect)(()=>{D.current&&P(D.current.getBoundingClientRect())},[D]),{containerRef:g,isVisible:U,baseHeaderLayoutRef:D,headerSize:L}},M=D=>{const{containerRef:L,isVisible:P,baseHeaderLayoutRef:g,headerSize:U}=x();return e.createElement(e.Fragment,null,e.createElement("div",{style:{height:U?.height},ref:L},P&&e.createElement(I,{ref:g,...D})),!P&&e.createElement(I,{...D,sticky:!0,width:U?.width}))};M.displayName="HeaderLayout";const b=(0,n.ZP)(r.x)`
  width: ${D=>D.width}px;
`,I=e.forwardRef(({navigationAction:D,primaryAction:L,secondaryAction:P,subtitle:g,title:U,sticky:B,width:Z,...F},te)=>{const w=typeof g=="string";return B?e.createElement(b,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,position:"fixed",top:0,right:0,background:"neutral0",shadow:"tableShadow",width:Z,zIndex:4,"data-strapi-header-sticky":!0},e.createElement(l.k,{justifyContent:"space-between"},e.createElement(l.k,null,D&&e.createElement(r.x,{paddingRight:3},D),e.createElement(r.x,null,e.createElement(A.Z,{variant:"beta",as:"h1",...F},U),w?e.createElement(A.Z,{variant:"pi",textColor:"neutral600"},g):g),P?e.createElement(r.x,{paddingLeft:4},P):null),e.createElement(l.k,null,L?e.createElement(r.x,{paddingLeft:2},L):void 0))):e.createElement(r.x,{ref:te,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:D?6:8,background:"neutral100","data-strapi-header":!0},D?e.createElement(r.x,{paddingBottom:2},D):null,e.createElement(l.k,{justifyContent:"space-between"},e.createElement(l.k,{minWidth:0},e.createElement(A.Z,{as:"h1",variant:"alpha",...F},U),P?e.createElement(r.x,{paddingLeft:4},P):null),L),w?e.createElement(A.Z,{variant:"epsilon",textColor:"neutral600",as:"p"},g):g)});I.displayName="BaseHeaderLayout",I.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0,sticky:!1,width:void 0},I.propTypes={navigationAction:i.node,primaryAction:i.node,secondaryAction:i.node,sticky:i.bool,subtitle:i.oneOfType([i.string,i.node]),title:i.string.isRequired,width:i.number},M.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0},M.propTypes={navigationAction:i.node,primaryAction:i.node,secondaryAction:i.node,subtitle:i.oneOfType([i.string,i.node]),title:i.string.isRequired}},17034:(m,E,t)=>{"use strict";t.d(E,{A:()=>u});var e=t(67294),i=t(45697),n=t(1565),r=t(41580);const l=(0,n.ZP)(r.x)`
  display: grid;
  grid-template-columns: ${({hasSideNav:f})=>f?"auto 1fr":"1fr"};
`,p=(0,n.ZP)(r.x)`
  overflow-x: hidden;
`,u=({sideNav:f,children:A})=>e.createElement(l,{hasSideNav:Boolean(f)},f,e.createElement(p,{paddingBottom:10},A));u.defaultProps={sideNav:void 0},u.propTypes={children:i.node.isRequired,sideNav:i.node}},185:(m,E,t)=>{"use strict";t.d(E,{o:()=>l});var e=t(67294),i=t(45697),n=t(1565);const r=n.ZP.main`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,l=({labelledBy:p,...u})=>{const f=p||"main-content-title";return e.createElement(r,{"aria-labelledby":f,id:"main-content",tabIndex:-1,...u})};l.defaultProps={labelledBy:void 0},l.propTypes={labelledBy:i.string}},67109:(m,E,t)=>{"use strict";t.d(E,{Z:()=>n});var e=t(85893);const i=r=>(0,e.jsx)("svg",{width:"1rem",height:"1rem",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:(0,e.jsx)("path",{d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z",fill:"#212134"})}),n=i},78114:(m,E,t)=>{"use strict";t.d(E,{Z:()=>n});var e=t(85893);const i=r=>(0,e.jsx)("svg",{width:"1rem",height:"1rem",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:(0,e.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.68 9.192c-.6.276-2.114 1.18-2.306 1.303a.792.792 0 0 0-.374.68v1.65a.797.797 0 0 0 .384.687c.254.16 1.73 1.042 2.306 1.303l.744 1.8c-.24.634-.67 2.333-.72 2.554a.797.797 0 0 0 .216.744l1.167 1.166a.801.801 0 0 0 .744.216l.03-.008c.36-.092 1.946-.498 2.523-.712l1.8.744c.276.6 1.181 2.115 1.304 2.307a.805.805 0 0 0 .679.374h1.649a.797.797 0 0 0 .686-.384c.16-.254 1.042-1.73 1.303-2.306l1.8-.744c.634.24 2.333.67 2.554.72a.797.797 0 0 0 .744-.216l1.166-1.167a.803.803 0 0 0 .216-.744l-.008-.03c-.092-.36-.498-1.946-.712-2.523l.744-1.8c.6-.276 2.115-1.181 2.307-1.304a.804.804 0 0 0 .374-.679v-1.649a.796.796 0 0 0-.382-.679c-.254-.16-1.73-1.041-2.306-1.303l-.744-1.8c.24-.634.67-2.333.72-2.554a.796.796 0 0 0-.216-.744l-1.166-1.173a.802.802 0 0 0-.744-.216l-.03.008c-.361.092-1.947.498-2.524.712l-1.8-.744c-.276-.6-1.18-2.115-1.303-2.307a.803.803 0 0 0-.68-.374h-1.65a.797.797 0 0 0-.68.382c-.16.254-1.041 1.73-1.303 2.306l-1.8.744c-.634-.24-2.333-.67-2.554-.72a.797.797 0 0 0-.744.216L2.921 4.094a.802.802 0 0 0-.216.744l.008.03c.092.361.498 1.947.712 2.524l-.744 1.8ZM12 17a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z",fill:"#212134"})}),n=i}}]);
